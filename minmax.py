data = """39,,,,,,,,,,,,
40,,,,,,,,,,,,
42,,,,,,,,,,,,
38,2.7,2.7,2.8,2.5,2.5,2.6,2.6,2.5,2.3,2.3,2.3,
43,18.2,18.2,18.6,17.4,17.2,17.9,17.7,17.2,16.1,16.1,15.8,
16,4,4,4.1,3.8,3.7,3.9,3.9,3.7,3.5,3.5,3.4,
6,3.5,3.5,3.6,3.3,3.3,3.4,3.4,3.3,3,3,3,
7,5.1,5.1,5.2,4.8,4.7,5,4.9,4.8,4.4,4.4,4.3,
8,10.4,10.4,10.7,9.9,9.8,10.2,10.1,9.8,9.1,9.1,8.9,
9,8.5,8.5,8.8,8.1,8,8.4,8.3,8,7.4,7.5,7.3,
20,3.6,3.6,3.7,3.4,3.3,3.5,3.5,3.4,3.1,3.1,3,
41,5.8,5.7,5.9,5.4,5.4,5.6,5.6,5.4,5,5,4.9,
44,4.6,4.6,4.8,4.4,4.3,4.5,4.5,4.4,4,4,4,
13,7.8,7.8,8,7.4,7.3,7.7,7.6,7.3,6.8,6.8,6.7,
14,15.5,15.5,15.9,14.8,14.6,15.2,15.1,14.6,13.7,13.7,13.5,
15,15.2,15.2,15.6,14.5,14.3,14.9,14.8,14.3,13.4,13.4,13.2,
45,11.6,11.6,11.9,11,10.9,11.4,11.3,10.9,10.2,10.2,10,
10,10.9,10.9,11.2,10.3,10.2,10.7,10.6,10.2,9.5,9.6,9.4,
11,6.5,6.5,6.7,6.2,6.1,6.4,6.3,6.1,5.7,5.7,5.6,
12,6.2,6.1,6.3,5.7,5.7,5.9,5.9,5.6,5.4,5.4,5.1,
17,21.1,21.1,21.6,20.2,19.9,20.8,20.6,20,18.7,18.8,18.5,
27,,,,,,,,,,,,
1,7.8,7.8,8,7.4,7.3,7.7,7.6,7.3,6.8,6.9,6.7,
2,6.7,6.7,6.9,6.3,6.2,6.5,6.5,6.3,5.8,5.8,5.7,
3,3.7,3.7,3.8,3.5,3.4,3.6,3.5,3.4,3.2,3.2,3.1,
4,7,7,7.1,6.6,6.5,6.8,6.7,6.5,6.1,6.1,5.9,
5,7.7,7.7,7.9,7.3,7.2,7.6,7.5,7.2,6.7,6.8,6.6,
18,6.7,6.7,6.9,6.1,6.2,6.4,6.4,6.1,5.8,5.8,5.5,
19,6.8,6.9,7,6.5,6.4,6.7,6.6,6.4,5.9,6,5.9,
21,19.1,19.1,19.6,18.2,18,18.8,18.6,18.1,16.9,17,16.7,
22,6.9,6.9,7.1,6.5,6.4,6.7,6.7,6.5,6,6,5.9,
23,8.6,8.6,8.8,8.1,8,8.4,8.3,8.1,7.5,7.5,7.4,
24,2.3,2.3,2.4,2.2,2.2,2.3,2.3,2.2,2,2,2,
25,19,19,19.5,18.2,17.9,18.7,18.5,18,16.8,16.9,16.6,
26,5.2,5.2,5.4,4.8,4.8,5,5,4.8,4.5,4.5,4.3,
28,3.5,3.5,3.6,3.3,3.2,3.4,3.4,3.3,3,3,2.9,
29,20,20.1,20.5,19.1,19,19.8,19.6,19.1,17.7,17.9,17.5,
30,7,7,7.2,6.6,6.6,6.9,6.8,6.6,6.1,6.1,6,
31,9.9,9.9,10.2,9.4,9.3,9.7,9.6,9.3,8.6,8.7,8.5,
32,0,0,0,0,0,0,0,0,0,0,0,
33,13.8,13.8,14.1,13.1,13,13.5,13.4,13,12.1,12.2,11.9,
34,10.7,10.7,11,10.2,10,10.5,10.4,10.1,9.4,9.4,9.2,
35,14,14,14.4,13.3,13.1,13.7,13.6,13.2,12.3,12.4,12.1,
36,18.7,18.8,19.2,17.9,17.7,18.4,18.3,17.7,16.6,16.7,16.3,
37,18.2,18.3,18.7,17.4,17.2,17.9,17.8,17.3,16.1,16.2,15.9,"""


lines = data.split('\n\n')

def explode(x):
	vals = x.split(',')
	new = []
	count = 0
	for a in vals:
		prev = 0
		if a:
			val = float(a)
			new.append(val)
		else:
			val = prev
			new.append(val)
		count += 1
		prev = val
	return new[:-1]


def foo():
	for x in map(explode, lines):
		cartodb_id = int(x[0])
		minx = min(x[1:])
		maxx = max(x[1:])
		print 'UPDATE unemployment_map_timeline SET minrate=%s where cartodb_id=%s;' % (minx, cartodb_id)
		print 'UPDATE unemployment_map_timeline SET maxrate=%s where cartodb_id=%s;' % (maxx, cartodb_id)
